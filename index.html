<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Firebase 帳號密碼登入範例</title>
    <style>
      :root {
        color-scheme: light dark;
      }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        margin: 0;
        padding: 2rem;
        display: grid;
        place-items: center;
        background: #0f172a;
        color: #e2e8f0;
      }
      .card {
        width: 100%;
        max-width: 560px;
        background: #0b1220;
        border: 1px solid #1f2937;
        border-radius: 12px;
        padding: 1.5rem;
        box-shadow: 0 8px 24px rgba(0,0,0,0.35);
      }
      h1 { font-size: 1.25rem; margin: 0 0 1rem; }
      .row { display: grid; grid-template-columns: 1fr; gap: 0.75rem; }
      label { font-size: 0.9rem; color: #93c5fd; }
      input[type="email"], input[type="password"], input[type="text"] {
        width: 100%;
        padding: 0.6rem 0.75rem;
        border-radius: 8px;
        border: 1px solid #334155;
        background: #0b1220;
        color: #e2e8f0;
      }
      .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 0.75rem; }
      button {
        padding: 0.6rem 0.75rem;
        border-radius: 8px;
        border: 1px solid #334155;
        background: #1d4ed8;
        color: white;
        cursor: pointer;
      }
      button.secondary { background: #334155; }
      .muted { font-size: 0.85rem; color: #94a3b8; }
      .message { margin-top: 0.75rem; font-size: 0.95rem; }
      .ok { color: #22c55e; }
      .err { color: #ef4444; }
      .divider { height: 1px; background: #1f2937; margin: 1rem 0; }
      .userBox { background: #0b1220; border: 1px dashed #334155; border-radius: 8px; padding: 0.75rem; }
      code { background: #0b1220; border: 1px solid #334155; padding: 0.2rem 0.4rem; border-radius: 6px; }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Firebase 帳號密碼登入/註冊</h1>

      <div class="row">
        <label for="email">Email</label>
        <input id="email" type="email" placeholder="you@example.com" />
      </div>
      <div class="row" style="margin-top:0.5rem;">
        <label for="password">密碼</label>
        <input id="password" type="password" placeholder="至少 6 個字元" />
      </div>

      <div class="actions">
        <button id="btnSignUp">註冊</button>
        <button id="btnSignIn" class="secondary">登入</button>
      </div>
      <div class="actions">
        <button id="btnReset" class="secondary">寄送重設密碼信</button>
        <button id="btnSignOut">登出</button>
      </div>

      <div id="msg" class="message"></div>

      <div class="divider"></div>

      <div class="userBox">
        <div class="muted">目前使用者狀態：</div>
        <div id="userState">尚未登入</div>
      </div>

      <div class="divider"></div>

      <p class="muted">
        使用前請至 Firebase Console 建立專案，啟用 <b>Email/Password</b>，
        並將你的 <code>firebaseConfig</code> 參數填入下方程式。
      </p>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
      import {
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        sendPasswordResetEmail,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-auth.js";

      // 將以下參數替換為你的 Firebase 專案設定
      const firebaseConfig = {
  apiKey: "AIzaSyCyTFIQn-gTHX8ipQ-oekus_d3Sg1kiHNY",
  authDomain: "nw-face-checkin.firebaseapp.com",
  projectId: "nw-face-checkin",
  storageBucket: "nw-face-checkin.firebasestorage.app",
  messagingSenderId: "187703864109",
  appId: "1:187703864109:web:675ba96fe40c111512c1a4",
  measurementId: "G-NRDLBL3NJP"
};

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      const $ = (id) => document.getElementById(id);
      const msg = $("msg");
      const userState = $("userState");

      const showMsg = (text, type = "ok") => {
        msg.textContent = text;
        msg.className = `message ${type}`;
      };

      const readInputs = () => ({
        email: $("email").value.trim(),
        password: $("password").value,
      });

      onAuthStateChanged(auth, (user) => {
        if (user) {
          userState.textContent = `已登入：${user.email}`;
        } else {
          userState.textContent = "尚未登入";
        }
      });

      $("btnSignUp").addEventListener("click", async () => {
        const { email, password } = readInputs();
        if (!email || !password) return showMsg("請輸入 Email 與密碼", "err");
        try {
          await createUserWithEmailAndPassword(auth, email, password);
          showMsg("註冊成功並已登入！", "ok");
        } catch (err) {
          showMsg(`註冊失敗：${err.code || err.message}`, "err");
        }
      });

      $("btnSignIn").addEventListener("click", async () => {
        const { email, password } = readInputs();
        if (!email || !password) return showMsg("請輸入 Email 與密碼", "err");
        try {
          await signInWithEmailAndPassword(auth, email, password);
          showMsg("登入成功！", "ok");
        } catch (err) {
          showMsg(`登入失敗：${err.code || err.message}`, "err");
        }
      });

      $("btnReset").addEventListener("click", async () => {
        const email = $("email").value.trim();
        if (!email) return showMsg("請輸入欲重設的 Email", "err");
        try {
          await sendPasswordResetEmail(auth, email);
          showMsg("已寄出重設密碼信（請到信箱檢查）", "ok");
        } catch (err) {
          showMsg(`寄送失敗：${err.code || err.message}`, "err");
        }
      });

      $("btnSignOut").addEventListener("click", async () => {
        try {
          await signOut(auth);
          showMsg("已登出", "ok");
        } catch (err) {
          showMsg(`登出失敗：${err.code || err.message}`, "err");
        }
      });
    </script>
  </body>
</html>